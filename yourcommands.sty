\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2
}

\lstset{style=mystyle}
\newcommand{\raiseTo}[2]{{#1}^{(#2)}}
\newcommand{\raiseToDagger}[2]{{#1}^{\dagger(#2)}}
\newcommand{\raiseToHat}[2]{\hat{#1}^{(#2)}}
\newcommand{\raiseToHatDagger}[2]{\hat{#1}^{\dagger(#2)}}


% Guidance on the command symbols ************************************************************
% \vhda means v hat alpha dagger
% \vha means v hat alpha 
% \vhma means v hat -alpha  here the m before the a means minus a
\newcommand{\vha}{\raiseToHat{v}{\alpha}}
\newcommand{\vhad}{\raiseToHatDagger{v}{\alpha}}
\newcommand{\vhma}{\raiseToDagger{v}{-\alpha}}


% We have bold symbols which appear in the vector and matrix representation of response 
% Epsilon represents the components of the fock matrix aka potential matrix
% The matrix elements epsilon_<i|F|j>
\newcommand{\Ediag}{\epsilon_{D}}
\newcommand{\Ediagd}{\epsilon_{1}^\dagger}
\newcommand{\Emdiag}{\epsilon_{1-D}}
\newcommand{\Emdiagd}{\epsilon_{1-D}^\dagger}
% BOLD symbols
\newcommand{\boldme}[1]{\mathbf{#1}}
% bold Fock matrix Diagonal and Off diagonal 
\newcommand{\beps}{\boldme{\Ediag}}
\newcommand{\bepsd}{\boldme{\Ediagd}}
\newcommand{\bepsm}{\boldme{\Emdiag}}
\newcommand{\bepsmd}{\boldme{\Emdiagd}}
% bold Lambda Theta Delta 
\newcommand{\bTheta}{\boldme{\Theta}}
\newcommand{\bLambda}{\boldme{\Lambda}}
\newcommand{\Lambdaa}{\raiseTo{\Lambda}{\alpha}}
\newcommand{\bLambdaa}{\boldme{\Lambdaa}}
\newcommand{\bDelta}{\boldme{\Delta}}

% Coulomb and HFxc
\newcommand{\Jhat}{\hat{J}}
\newcommand{\Khat}{\hat{K}}

% foc and HFxc
\newcommand{\hhat}{\hat{h}}
\newcommand{\fhat}{\hat{f}}

% f stands for the fock operator response
\newcommand{\fhata}{\raiseToHat{f}{\alpha}}
\newcommand{\fhatab}{\raiseToHat{f}{\alpha\beta}}

% g stands for electron interation terms
% gh ghat
% gha gh alpha
% ghn gh n
% ghab gh alpha beta 
\newcommand{\gh}{\hat{g}}
\newcommand{\ghz}{\raiseToHat{g}{0}}
\newcommand{\gha}{\raiseToHat{g}{\alpha}}
\newcommand{\ghn}{\raiseToHat{g}{n}}
\newcommand{\ghab}{\raiseToHat{g}{\alpha\beta}}
% bold matrix and vector potentials
\newcommand{\bV}{\boldme{V}}
\newcommand{\bVa}{\boldme{\raiseTo{V}{\alpha}}}
\newcommand{\bVm}{\boldme{\raiseTo{V}{m}}}
\newcommand{\bVone}{\boldme{\raiseTo{V}{1}}}
\newcommand{\bVtwo}{\boldme{\raiseTo{V}{2}}}
% chi response vector
\newcommand{\chim}{\raiseTo{\chi}{m}}
\newcommand{\chin}{\raiseTo{\chi}{n}}
\newcommand{\bchim}{\boldme{\chim}}
\newcommand{\bchin}{\boldme{\chin}}
\newcommand{\chia}{\raiseTo{\chi}{\alpha}}
\newcommand{\chib}{\raiseTo{\chi}{\beta}}
\newcommand{\bchi}{\boldme{\chi}}
\newcommand{\bchione}{\boldsymbol{\chi^{(1)}}}
\newcommand{\bchitwo}{\boldsymbol{\chi^{(2)}}}
\newcommand{\bchia}{\boldsymbol{\chia}}
\newcommand{\bchib}{\bold\boldsymbol{\chib}}
% G the BSH Operator 
\newcommand{\Gh}{\hat{G}}
\newcommand{\Ghz}{\raiseToHat{G}{0}}
\newcommand{\Gha}{\raiseToHat{G}{\alpha}}
\newcommand{\Ghn}{\raiseToHat{G}{n}}
\newcommand{\Ghb}{\raiseToHat{G}{\beta}}
\newcommand{\Ghab}{\raiseToHat{G}{\alpha\beta}}
% BOLD G the BSH Operator 
\newcommand{\bGh}{\boldme{\Gh}}
\newcommand{\bGha}{\boldme{\Gha}}
\newcommand{\bGhone}{\boldme{\Gh}^{(1)}}
\newcommand{\bGhtwo}{\boldme{\Gh}^{(2)}}
\newcommand{\bGhm}{\boldme{\Gh}^{(m)}}

% Potentials J K Gamma
\newcommand{\Jh}{\hat{J}}
\newcommand{\Jhz}{\raiseTo{J}{0}}
\newcommand{\Jha}{\raiseTo{J}{\alpha}}

\newcommand{\Kh}{\hat{K}}
\newcommand{\Khz}{\raiseTo{K}{0}}
\newcommand{\Kha}{\raiseTo{K}{\alpha}}
\newcommand{\Khad}{\raiseToHatDagger{K}{\alpha}}

\newcommand{\vextz}{\hat{v}_{ext}^{(0)}}
\newcommand{\vexta}{\hat{v}_{ext}^{(\alpha)}}

\newcommand{\Th}{\hat{T}}

\newcommand{\Gammam}{\Gamma^{(m)}}
\newcommand{\Gammadm}{\Gamma^{\dagger(m)}}
\newcommand{\Gamman}{\Gamma^{(n)}}
\newcommand{\Gammadn}{\Gamma^{\dagger(n)}}

\newcommand{\bGammam}{\boldsymbol{\Gammam}}
\newcommand{\bGammadm}{\boldsymbol{\Gammadm}}
\newcommand{\bGamman}{\boldsymbol{\Gamman}}
\newcommand{\bGammadn}{\boldsymbol{\Gammadn}}

\newcommand{\Gammaa}{\Gamma^{(\alpha)}}
\newcommand{\Gammada}{\Gamma^{\dagger(\alpha)}}

\newcommand{\Gammaab}{\Gamma^{(\alpha\beta)}}
\newcommand{\Gammadab}{\Gamma^{\dagger(\alpha\beta)}}

\newcommand{\bGammaa}{\boldsymbol{\Gamma^{(\alpha)}}}
\newcommand{\bGammada}{\boldsymbol{\Gamma^{\dagger(\alpha)}}}


\newcommand{\boldA}{\boldsymbol{A}}
\newcommand{\boldB}{\boldsymbol{B}}

\newcommand{\Gammah}{\hat{\Gamma}}
\newcommand{\Gammahz}{\hat{\Gamma}^{(0)}}
\newcommand{\Gammahn}{\hat{\Gamma}^{(n)}}
\newcommand{\Gammaha}{\hat{\Gamma}^{(\alpha)}}
\newcommand{\Gammahb}{\hat{\Gamma}^{(\alpha)}}

\newcommand{\Gammahab}{\hat{\Gamma}^{(\alpha\beta)}}
\newcommand{\Gammahdab}{\hat{\Gamma}^{\dagger(\alpha\beta)}}

\newcommand{\pgz}{\pdv{\gh}{\rho}\qty[\rho^0]}
\newcommand{\pjz}{\pdv{\Jh}{\rho}\qty[\rho^0]}
\newcommand{\pkz}{\pdv{\Kh}{\rho}\qty[\rho^0]}
\newcommand{\pvz}{\pdv{\vext}{\rho}\qty[\rho^0]}
    
\newcommand{\la}{\lambda_{\alpha}}
\newcommand{\lb}{\lambda_{\beta}}
\newcommand{\lc}{\lambda_{\gamma}}

\newcommand{\partialfa}{\eval{\pdv{f}{\la}}_{\lambda=0}}
\newcommand{\partialfb}{\eval{\pdv{f}{\lb}}_{\lambda=0}}
\newcommand{\partialfab}{\eval{\pdv{f}{\la}{\lb}}_{\lambda=0}}

\newcommand{\rhon}{\rho^{(n)}}
\newcommand{\rhoz}{\rho^{(0)}}
\newcommand{\rhoa}{\rho^{(\alpha)}}
\newcommand{\rhoda}{\rho^{\dagger(\alpha)}}

\newcommand{\gammaxa}{\Gamma_p[\xa](r)}
\newcommand{\gammaya}{\Gamma_p[\ya](r)}
\newcommand{\gammaxda}{\Gamma_p[\xda](r)}
\newcommand{\gammayda}{\Gamma_p[\yda](r)}

\newcommand{\xn}{x^{(n)}}
\newcommand{\xdn}{x^{\dagger(n)}}
\newcommand{\yn}{y^{(n)}}
\newcommand{\ydn}{y^{\dagger(n)}}

\newcommand{\xm}{x^{(m)}}
\newcommand{\xdm}{x^{\dagger(m)}}
\newcommand{\ym}{y^{(m)}}
\newcommand{\ydm}{y^{\dagger(m)}}


\newcommand{\bxm}{\boldsymbol{\xm}}
\newcommand{\bxdm}{\boldsymbol{\xdm}}
\newcommand{\bym}{\boldsymbol{\ym}}
\newcommand{\bydm}{\boldsymbol{\ydm}}

\newcommand{\bxn}{\boldsymbol{\xn}}
\newcommand{\bxdn}{\boldsymbol{\xdn}}
\newcommand{\byn}{\boldsymbol{\yn}}
\newcommand{\bydn}{\boldsymbol{\ydn}}

\newcommand{\xa}{x^{(\alpha)}}
\newcommand{\xda}{x^{\dagger(\alpha)}}
\newcommand{\ya}{y^{(\alpha)}}
\newcommand{\yda}{y^{\dagger(\alpha)}}

\newcommand{\bxa}{\boldsymbol{\xa}}
\newcommand{\bxda}{\boldsymbol{\xda}}
\newcommand{\bya}{\boldsymbol{\ya}}
\newcommand{\byda}{\boldsymbol{\yda}}

\newcommand{\xb}{x^{(\beta)}}
\newcommand{\xdb}{x^{\dagger(\beta)}}

\newcommand{\yb}{y^{(\beta)}}
\newcommand{\ydb}{y^{\dagger(\beta)}}

\newcommand{\xha}{\hat{x}^{(\alpha)}}
\newcommand{\yha}{\hat{y}^{(\alpha)}}

\newcommand{\xhda}{\hat{x}^{\dagger(\alpha)}}
\newcommand{\yhda}{\hat{y}^{\dagger(\alpha)}}

\newcommand{\xhb}{\hat{x}^{(\beta)}}
\newcommand{\yhb}{\hat{y}^{(\beta)}}

\newcommand{\xab}{x^{(\alpha\beta)}}
\newcommand{\yab}{y^{(\alpha\beta)}}
\newcommand{\pab}{p^{(\alpha\beta)}}
\newcommand{\qab}{q^{(\alpha\beta)}}

\newcommand{\pdab}{p^{\dagger(\alpha\beta)}}
\newcommand{\qdab}{q^{\dagger(\alpha\beta)}}

\newcommand{\xhab}{\hat{x}^{(\alpha\beta)}}
\newcommand{\yhab}{\hat{y}^{(\alpha\beta)}}
\newcommand{\phab}{\hat{p}^{(\alpha\beta)}}
\newcommand{\qhab}{\hat{q}^{(\alpha\beta)}}

\newcommand{\phip}{\phi_{p}}


\newcommand{\rhat}{\hat{\rho}}
\newcommand{\rha}{\hat{\rho}^{(\alpha)}}
\newcommand{\rhn}{\hat{\rho}^{(n)}}
\newcommand{\rhab}{\hat{\rho}^{(\alpha\beta)}}
\newcommand{\rhb}{\hat{\rho}^{(\beta)}}
\newcommand{\rhz}{\hat{\rho}^{(0)}}
\newcommand{\rhma}{\hat{\rho}^{(-\alpha)}}

\newcommand{\Fhat}{\hat{F}}
\newcommand{\Fha}{\hat{F}^{(\alpha)}}
\newcommand{\Fhb}{\hat{F}^{(\beta)}}
\newcommand{\Fhda}{\hat{F}^{\dagger(\alpha)}}
\newcommand{\Fhdb}{\hat{F}^{\dagger(\beta)}}
\newcommand{\Fhz}{\hat{F}^{(0)}}
\newcommand{\Fhab}{\hat{F}^{(\alpha\beta)}}

\newcommand{\emia} {e^{-i\omega_\alpha t}}
\newcommand{\eia} {e^{i\omega_\alpha t}}

\newcommand{\eiab} {e^{i\qty(\omegaa+\omegab) t}}
\newcommand{\eimab} {e^{i\qty(-\omegaa+\omegab) t}}
\newcommand{\eiamb} {e^{i\qty(\omegaa-\omegab) t}}
\newcommand{\eimamb} {e^{-i\qty(\omegaa+\omegab) t}}


% second order
\newcommand{\vhaa}{\hat{v}^{(\alpha\alpha)}}
\newcommand{\vhab}{\hat{v}^{(\alpha\beta)}}
\newcommand{\vhba}{\hat{v}^{(\beta\alpha)}}
\newcommand{\vhbb}{\hat{v}^{(\beta\beta)}}
%\omegas 
\newcommand{\omegaa}{\omega_{\alpha}}
\newcommand{\omegab}{\omega_{\beta}}

%sums
\newcommand{\sumNocc}{\sum_i^{N_{occ}}}
\newcommand{\Q}{\qty(1-\rhz)}


\newcommand{\vaa}{v^{(\alpha)}}

\newcommand{\bl}{\boldsymbol{\lambda }}

\newcommand{\fz}{f^{(0)}}
\newcommand{\fa}{f^{(\alpha)}}
\newcommand{\fb}{f^{(\beta)}}
\newcommand{\fab}{f^{(\alpha\beta)}}

%\omegas 
\newcommand{\wa}{\omega_{\alpha}}
\newcommand{\wb}{\omega_{\beta}}

%\lambdas  
\newcommand{\lba}{\lambda_\alpha}
\newcommand{\lbb}{\lambda_\beta}

%\gammas  
\newcommand{\gammaz}{\gamma^{(0)}}
\newcommand{\gammaa}{\gamma^{(\alpha)}}
\newcommand{\gammab}{\gamma^{(\beta)}}
\newcommand{\gammaab}{\gamma^{(\alpha\beta)}}

%\H  
\newcommand{\Hz}{H^{(0)}}
\newcommand{\Ha}{H^{(\alpha)}}
\newcommand{\Hb}{H^{(\beta)}}
\newcommand{\Hab}{H^{(\alpha\beta)}}

\newcommand{\Vz}{V^{(0)}}
\newcommand{\Vdz}{V^{\dagger(0)}}
\newcommand{\Vab}{V^{(\alpha\beta)}}
\newcommand{\Vdab}{V^{\dagger(\alpha\beta)}}

\newcommand{\Va}{V^{(\alpha)}}
\newcommand{\Vda}{V^{\dagger(\alpha)}}

\newcommand{\Qhat}{\hat{Q}}
\newcommand{\Phat}{\hat{P}}
\newcommand{\gammazh}{\hat{\gamma}^{(0)}}

\newcommand{\xia}{x_i^{(\alpha)}}
\newcommand{\yia}{y_i^{(\alpha)}}

\newcommand{\xiad}{x_i^{(\alpha) \dagger}}
\newcommand{\yiad}{y_i^{(\alpha) \dagger}}

